---
title: "Model"
subtitle: "What is the best and worst genre to listen to to decrease depression levels?"
execute:
  echo: FALSE
  message: FALSE
  warning: FALSE
---

```{r}
#| label: setup
#| message: false
#| warning: false
library(tidyverse)
library(primer.data)
library(brms)
library(tidybayes)
library(gtsummary)

df <- read_csv("data/mxmh_survey_results.csv")
```

```{r}
df_filtered <- df |> 
  rename(music_effects = "Music effects",
         fav_genre = "Fav genre",
         depression = "Depression",
         anxiety = "Anxiety",
         insomnia = "Insomnia",
         ocd = "OCD",
         lofi_freq = "Frequency [Lofi]",
         gospel_freq = "Frequency [Gospel]") |> 
  select(fav_genre, depression, anxiety, insomnia, ocd, music_effects, gospel_freq, lofi_freq) |> 
  filter(!is.na(fav_genre), 
         !is.na(depression), 
         !is.na(music_effects), 
         !is.na(anxiety), 
         !is.na(insomnia), 
         !is.na(ocd))

```

To answer the question of which genre is the best to listen to, we first have to see which of the favorite genres are most associated with high/low levels of depression, by using a bayesian regression model. For this initial model, we are using this formula:

$$
depression = \beta_{0} + \beta_{1} fav\_genre_i
$$
```{r}
#| label: general analysis
#| cache: true

fit_gen <- brm(formula = depression ~ fav_genre,
                  data = df_filtered,
                  family = gaussian(),
                  refresh = 0,
                  silent = 2,
                  seed = 9)

tbl_regression(fit_gen)
```

We see that on average, gospel listeners generally have lower levels of depression, while lofi listeners generally have higher levels of depression. We calculate this further using this model:

$$
depression = \beta_{0} + \beta_{1} gospel\_freq_i + \beta_{2} lofi\_freq_i + \beta_{3} music\_effects_i
$$

```{r}
#| label: gospel and lofi analysis
#| cache: true

fit_gospel_lofi <- brm(formula = depression ~ gospel_freq + lofi_freq + music_effects,
                  data = df_filtered,
                  family = gaussian(),
                  refresh = 0,
                  silent = 2,
                  seed = 9)

fit_gospel_lofi
```

To give us a baseline of how music can transform mental health, we include the music effects variable. While listening to gospel music frequently seems to have a little bit of an effect on lowering levels of depression, listening to lofi has no effect on increasing or decreasing depression levels. 

```{r}
tbl_regression(fit_gospel_lofi)
```

In summary, there is no definite genre that listening to increases or decreases depression levels, though listening to the gospel genre might make a bit of an effect. This may be because of the religious ties to gospel music, which generally connects people and helps them mentally. 

Like every bayesian regression model, this model is not completely accurate in that it was only sent out on a couple social media platforms (Reddit, Discord, other social media), which doesn't include data from people not involved online, and was advertised on posters and business cards (which restrict the data to a certain proximity).

